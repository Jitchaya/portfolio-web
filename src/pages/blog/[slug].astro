---
import { getCollection, render } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Sidebar from '../../components/Sidebar.astro';
import Navbar from '../../components/Navbar.astro';

export async function getStaticPaths() {
  const blogs = await getCollection('blogs');
  return blogs.map((blog) => ({
    params: { slug: blog.id },
    props: { blog },
  }));
}

const { blog } = Astro.props;
const { Content } = await render(blog);

const formattedDate = new Date(blog.data.date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<Layout title={`${blog.data.title} | Jitchaya Veerachodthada`}>
    <Sidebar />
    <main class="lg:ml-88 grow flex flex-col">
      <Navbar />

      <!-- Back Link -->
      <a
        href="/blog"
        class="inline-flex items-center gap-1 text-sm text-slate-500 hover:text-primary transition-colors mb-8"
      >
        <span class="material-symbols-outlined text-[18px]">arrow_back</span>
        Back to Blog
      </a>

      <!-- Post Header -->
      <div class="mb-8">
        <div class="flex items-center gap-2 mb-4">
          <span class="material-symbols-outlined text-[16px] text-slate-400">calendar_today</span>
          <span class="text-sm text-slate-500 dark:text-slate-400">{formattedDate}</span>
        </div>
        <h1 class="text-3xl md:text-5xl font-bold tracking-tight mb-4">
          {blog.data.title}
        </h1>
        <p class="text-slate-500 dark:text-slate-400 text-lg max-w-2xl mb-6">
          {blog.data.description}
        </p>
        <div class="flex flex-wrap gap-2">
          {blog.data.tags.map((tag: string) => (
            <span class="text-xs font-medium px-3 py-1 rounded-full bg-primary/20 text-slate-700 dark:text-slate-300">
              {tag}
            </span>
          ))}
        </div>
      </div>

      <!-- Featured Image -->
      {blog.data.image && (
        <div class="rounded-2xl overflow-hidden mb-10">
          <img
            src={blog.data.image}
            alt={blog.data.title}
            class="w-full h-auto object-cover"
          />
        </div>
      )}

      <!-- Post Content -->
      <article class="prose prose-slate dark:prose-invert prose-lg max-w-none mb-16
        prose-headings:font-bold prose-headings:tracking-tight
        prose-h2:text-2xl prose-h2:mt-10 prose-h2:mb-4
        prose-h3:text-xl prose-h3:mt-8 prose-h3:mb-3
        prose-p:leading-relaxed prose-p:text-slate-600 dark:prose-p:text-slate-300
        prose-a:text-primary hover:prose-a:underline
        prose-code:bg-slate-100 dark:prose-code:bg-slate-800 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm
        prose-pre:bg-slate-900 dark:prose-pre:bg-slate-800 prose-pre:rounded-xl
        prose-ol:list-decimal prose-ul:list-disc
        prose-li:text-slate-600 dark:prose-li:text-slate-300
        prose-strong:text-slate-900 dark:prose-strong:text-white
      ">
        <Content />
      </article>
    </main>
</Layout>

